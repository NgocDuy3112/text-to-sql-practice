# LLM được sử dụng: `ollama:qwen3:1.7b`

### Prompt sử dụng:

```
Bạn là một chuyên gia ngôn ngữ học giúp chuẩn hóa câu hỏi của người dùng dựa trên ngữ cảnh hội thoại. Hãy thực hiện các bước sau:

- Phân tích ngữ cảnh: Nghiên cứu lịch sử trò chuyện để xác định các thực thể (đối tượng, địa điểm, thời gian, chương trình...) đang được đề cập.

- Tổng hợp thông tin: Kết hợp câu hỏi mới nhất với các thông tin ẩn dụ hoặc bị lược bỏ từ lịch sử để tạo thành một câu hỏi đầy đủ thông tin.

- Tinh gọn & Làm rõ: Loại bỏ các từ thừa, sửa lỗi diễn đạt để câu hỏi mạch lạc và phản ánh chính xác ý định gốc của người dùng.

** Định dạng đầu ra **: Chỉ trả về duy nhất một chuỗi văn bản (string) là câu hỏi đã chuẩn hóa. Không giải thích, không thêm văn bản phụ trợ và không trả lời câu hỏi đó.
```

### Kết quả:
```
> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Xin chào"}, {"role": "assistant", "content": "Chào bạn, tôi có thể giúp gì?"}]
  Câu hỏi: Hiện có bao nhiêu chương trình học
  Mẫu kết quả: Hiện có bao nhiêu chương trình học
  > Kết quả thật: Số lượng chương trình đào tạo hiện có là bao nhiêu?

> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Bạn là ai"}, {"role": "assistant", "content": "Tôi là chatbot hỗ trợ khai thác dữ liệu đào tạo"}]
  Câu hỏi: Danh sách các lớp học hiện có
  Mẫu kết quả: Danh sách các lớp học hiện có
  > Kết quả thật: Danh sách các lớp học hiện có

> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Chương trình lập trình cơ bản hiện có mấy lớp"}, {"role": "assistant", "content": "Chương trình lập trình cơ bản hiện có 5 lớp"}, {"role": "user", "content": "Tổng học viên của cả 5 lớp là bao nhiêu"}, {"role": "assistant", "content": "Tổng học viên của 5 lớp lập trình cơ bản là 30"}]
  Câu hỏi: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh, sinh 2000
  Mẫu kết quả: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh sinh năm 2000
  > Kết quả thật: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh, sinh 2000

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Lớp VP01 thuộc chương trình nào"}, {"role": "assistant", "content": "Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản"}]
  Câu hỏi: Lớp đó có bao nhiêu học viên
  Mẫu kết quả: Lớp VP01 có bao nhiêu học viên
  > Kết quả thật: Lớp VP01 có bao nhiêu học viên?

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Chương trình Python cơ bản có học phí bao nhiêu"}, {"role": "assistant", "content": "Học phí là 2.500.000 đồng"}]
  Câu hỏi: Chương trình đó học bao lâu
  Mẫu kết quả: Chương trình Python cơ bản học bao lâu
  > Kết quả thật: Chương trình Python cơ bản có thời gian học là bao lâu?

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Ai là giảng viên chính của lớp PY01"}, {"role": "assistant", "content": "Giảng viên chính là Lê Thanh Sơn"}, {"role": "user", "content": "Lớp này có bao nhiêu học viên"}, {"role": "assistant", "content": "Lớp PY01 có 20 học viên."}]
  Câu hỏi: Những học viên đó có điểm cuối khóa chưa
  Mẫu kết quả: Những học viên của lớp PY01 có điểm cuối khóa chưa
  > Kết quả thật: Các học viên trong lớp PY01 có điểm cuối khóa chưa?

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Lớp VP01 thuộc chương trình nào"}, {"role": "assistant", "content": "Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản"}]
  Câu hỏi: Cho tôi biết lịch học của lớp đó
  Mẫu kết quả: Cho tôi biết thời khoá biểu của lớp VP01
  > Kết quả thật: Lịch học của lớp VP01 là gì?
```



### Prompt sử dụng:
```
Bạn là một chuyên gia xử lý ngôn ngữ tự nhiên, có nhiệm vụ tái cấu trúc câu hỏi của người dùng để tạo ra một truy vấn (query) độc lập, đầy đủ ngữ cảnh và rõ ràng.

** Quy trình xử lý: **
1. Kiểm tra lịch sử: Phân tích độ dài của nội dung trong lịch sử trò chuyện.
2. Xác định chiến lược:
    + Nếu lịch sử dài (> 200 ký tự): Chỉ tập trung vào câu hỏi mới nhất, cùng với tối đa 5 lượt trò chuyện trước đó. Chỉnh sửa lỗi chính tả hoặc diễn đạt (nếu có) để câu hỏi chuyên nghiệp hơn, nhưng không cần ghép thêm thông tin từ lịch sử để tránh làm loãng truy vấn.
    + Nếu lịch sử ngắn (< 200 ký tự): Tổng hợp các thực thể (tên lớp, mã môn, thời gian, đối tượng...) từ lịch sử vào câu hỏi mới để tạo thành một câu hỏi có đầy đủ chủ ngữ, vị ngữ và ngữ cảnh cụ thể.
3. Chuẩn hóa: Loại bỏ các từ thừa (ví dụ: "à", "nhỉ", "cho mình hỏi"), giữ nguyên ý định gốc và đảm bảo câu văn mạch lạc.

** Ràng buộc đầu ra: **
- Chỉ trả về duy nhất chuỗi văn bản (string) là câu hỏi đã được chuẩn hóa.
- Tuyệt đối không trả lời câu hỏi, không thêm lời dẫn giải, không có dấu ngoặc kép bao quanh trừ khi nó là một phần của tên riêng.
```


### Kết quả:
```
>>> Thành phần cho kết quả <<<

> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Xin chào"}, {"role": "assistant", "content": "Chào bạn, tôi có thể giúp gì?"}]
  Câu hỏi: Hiện có bao nhiêu chương trình học
  Mẫu kết quả: Hiện có bao nhiêu chương trình học
  > Kết quả thật: Hiện có bao nhiêu chương trình học?

> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Bạn là ai"}, {"role": "assistant", "content": "Tôi là chatbot hỗ trợ khai thác dữ liệu đào tạo"}]
  Câu hỏi: Danh sách các lớp học hiện có
  Mẫu kết quả: Danh sách các lớp học hiện có
  > Kết quả thật: Danh sách các lớp học hiện có

> Loại hình câu hỏi: Câu hỏi đơn - Lịch sử không liên quan, bỏ qua
  Lịch sử: [{"role": "user", "content": "Chương trình lập trình cơ bản hiện có mấy lớp"}, {"role": "assistant", "content": "Chương trình lập trình cơ bản hiện có 5 lớp"}, {"role": "user", "content": "Tổng học viên của cả 5 lớp là bao nhiêu"}, {"role": "assistant", "content": "Tổng học viên của 5 lớp lập trình cơ bản là 30"}]
  Câu hỏi: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh, sinh 2000
  Mẫu kết quả: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh sinh năm 2000
  > Kết quả thật: Tìm điểm cuối khóa lớp lập trình nâng cao của Nguyễn Văn Anh, sinh 2000

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Lớp VP01 thuộc chương trình nào"}, {"role": "assistant", "content": "Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản"}]
  Câu hỏi: Lớp đó có bao nhiêu học viên
  Mẫu kết quả: Lớp VP01 có bao nhiêu học viên
  > Kết quả thật: Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản có bao nhiêu học viên?

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Chương trình Python cơ bản có học phí bao nhiêu"}, {"role": "assistant", "content": "Học phí là 2.500.000 đồng"}]
  Câu hỏi: Chương trình đó học bao lâu
  Mẫu kết quả: Chương trình Python cơ bản học bao lâu
  > Kết quả thật: Chương trình Python cơ bản học bao lâu

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Ai là giảng viên chính của lớp PY01"}, {"role": "assistant", "content": "Giảng viên chính là Lê Thanh Sơn"}, {"role": "user", "content": "Lớp này có bao nhiêu học viên"}, {"role": "assistant", "content": "Lớp PY01 có 20 học viên."}]
  Câu hỏi: Những học viên đó có điểm cuối khóa chưa
  Mẫu kết quả: Những học viên của lớp PY01 có điểm cuối khóa chưa
  > Kết quả thật: Lớp PY01 có bao nhiêu học viên và điểm cuối khóa đã được hoàn thành chưa?

> Loại hình câu hỏi: Câu hỏi tiếp nối - Tham chiếu thực thể trong lịch sử
  Lịch sử: [{"role": "user", "content": "Lớp VP01 thuộc chương trình nào"}, {"role": "assistant", "content": "Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản"}]
  Câu hỏi: Cho tôi biết lịch học của lớp đó
  Mẫu kết quả: Cho tôi biết thời khoá biểu của lớp VP01
  > Kết quả thật: Lớp VP01 thuộc chương trình Tin học văn phòng cơ bản có lịch học gì?
```